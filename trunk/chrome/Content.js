(function(){var h=true,j=null,k=false,m,p=this;
function q(a){var b=typeof a;if(b=="object")if(a){if(a instanceof Array)return"array";else if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if(c=="[object Window]")return"object";if(c=="[object Array]"||typeof a.length=="number"&&typeof a.splice!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("splice"))return"array";if(c=="[object Function]"||typeof a.call!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if(b=="function"&&typeof a.call=="undefined")return"object";return b}function s(a){var b=q(a);return b=="array"||b=="object"&&typeof a.length=="number"}function t(a){return typeof a=="string"}function u(a){return a[aa]||(a[aa]=++ba)}var aa="closure_uid_"+Math.floor(Math.random()*2147483648).toString(36),ba=0;function ca(a,b){function c(){}c.prototype=b.prototype;a.X=b.prototype;a.prototype=new c};function x(a,b){if(a<b)return-1;else if(a>b)return 1;return 0};var y,z,A,B;function da(){return p.navigator?p.navigator.userAgent:j}B=A=z=y=k;var C;if(C=da()){var ea=p.navigator;y=C.indexOf("Opera")==0;z=!y&&C.indexOf("MSIE")!=-1;A=!y&&C.indexOf("WebKit")!=-1;B=!y&&!A&&ea.product=="Gecko"}var ga=y,D=z,E=B,F=A,ha=p.navigator,ia=(ha&&ha.platform||"").indexOf("Mac")!=-1,G;
a:{var H="",I;if(ga&&p.opera){var J=p.opera.version;H=typeof J=="function"?J():J}else{if(E)I=/rv\:([^\);]+)(\)|;)/;else if(D)I=/MSIE\s+([^\);]+)(\)|;)/;else if(F)I=/WebKit\/(\S+)/;if(I){var ja=I.exec(da());H=ja?ja[1]:""}}if(D){var K,ka=p.document;K=ka?ka.documentMode:undefined;if(K>parseFloat(H)){G=String(K);break a}}G=H}var la={};
function L(a){var b;if(!(b=la[a])){b=0;for(var c=String(G).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),f=Math.max(c.length,d.length),e=0;b==0&&e<f;e++){var g=c[e]||"",i=d[e]||"",l=RegExp("(\\d*)(\\D*)","g"),o=RegExp("(\\d*)(\\D*)","g");do{var v=l.exec(g)||["","",""],n=o.exec(i)||["","",""];if(v[0].length==0&&n[0].length==0)break;b=x(v[1].length==0?0:parseInt(v[1],10),n[1].length==0?0:parseInt(n[1],10))||x(v[2].length==0,n[2].length==
0)||x(v[2],n[2])}while(b==0)}b=la[a]=b>=0}return b}var ma={};function M(){return ma[9]||(ma[9]=D&&!!document.documentMode&&document.documentMode>=9)};var na=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([\\w\\d\\-\\u0100-\\uffff.%]*)(?::([0-9]+))?)?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");function oa(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function pa(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b};var N=Array.prototype,qa=N.indexOf?function(a,b,c){return N.indexOf.call(a,b,c)}:function(a,b,c){c=c==j?0:c<0?Math.max(0,a.length+c):c;if(t(a)){if(!t(b)||b.length!=1)return-1;return a.indexOf(b,c)}for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},ra=N.forEach?function(a,b,c){N.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=t(a)?a.split(""):a,e=0;e<d;e++)e in f&&b.call(c,f[e],e,a)};function sa(){return N.concat.apply(N,arguments)}
function ta(a){var b=a.length;if(b>0){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]};function ua(a){if(typeof a.f=="function")return a.f();if(t(a))return a.split("");if(s(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return oa(a)}function va(a,b,c){if(typeof a.forEach=="function")a.forEach(b,c);else if(s(a)||t(a))ra(a,b,c);else{var d;if(typeof a.l=="function")d=a.l();else if(typeof a.f!="function")if(s(a)||t(a)){d=[];for(var f=a.length,e=0;e<f;e++)d.push(e)}else d=pa(a);else d=void 0;f=ua(a);e=f.length;for(var g=0;g<e;g++)b.call(c,f[g],d&&d[g],a)}};function O(a){this.g={};this.c=[];var b=arguments.length;if(b>1){if(b%2)throw Error("Uneven number of arguments");for(var c=0;c<b;c+=2)this.j(arguments[c],arguments[c+1])}else if(a){if(a instanceof O){b=a.l();c=a.f()}else{b=pa(a);c=oa(a)}for(var d=0;d<b.length;d++)this.j(b[d],c[d])}}m=O.prototype;m.a=0;m.M=0;m.f=function(){wa(this);for(var a=[],b=0;b<this.c.length;b++)a.push(this.g[this.c[b]]);return a};m.l=function(){wa(this);return this.c.concat()};m.p=function(a){return P(this.g,a)};
m.remove=function(a){if(P(this.g,a)){delete this.g[a];this.a--;this.M++;this.c.length>2*this.a&&wa(this);return h}return k};function wa(a){if(a.a!=a.c.length){for(var b=0,c=0;b<a.c.length;){var d=a.c[b];if(P(a.g,d))a.c[c++]=d;b++}a.c.length=c}if(a.a!=a.c.length){var f={};for(c=b=0;b<a.c.length;){d=a.c[b];if(!P(f,d)){a.c[c++]=d;f[d]=1}b++}a.c.length=c}}m.k=function(a,b){if(P(this.g,a))return this.g[a];return b};m.j=function(a,b){if(!P(this.g,a)){this.a++;this.c.push(a);this.M++}this.g[a]=b};m.o=function(){return new O(this)};
function P(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Q(a,b){var c;if(a instanceof Q){this.e=b!==undefined?b:a.e;xa(this,a.n);c=a.B;R(this);this.B=c;c=a.q;R(this);this.q=c;ya(this,a.A);c=a.z;R(this);this.z=c;za(this,a.h.o());c=a.t;R(this);this.t=c}else if(a&&(c=String(a).match(na))){this.e=!!b;xa(this,c[1]||"",h);var d=c[2]||"";R(this);this.B=d?decodeURIComponent(d):"";d=c[3]||"";R(this);this.q=d?decodeURIComponent(d):"";ya(this,c[4]);d=c[5]||"";R(this);this.z=d?decodeURIComponent(d):"";za(this,c[6]||"",h);c=c[7]||"";R(this);this.t=c?decodeURIComponent(c):
""}else{this.e=!!b;this.h=new S(j,0,this.e)}}m=Q.prototype;m.n="";m.B="";m.q="";m.A=j;m.z="";m.t="";m.R=k;m.e=k;m.toString=function(){var a=[],b=this.n;b&&a.push(T(b,Aa),":");if(b=this.q){a.push("//");var c=this.B;c&&a.push(T(c,Aa),"@");a.push(encodeURIComponent(String(b)));b=this.A;b!=j&&a.push(":",String(b))}if(b=this.z){this.q&&b.charAt(0)!="/"&&a.push("/");a.push(T(b,b.charAt(0)=="/"?Ba:Ca))}(b=this.h.toString())&&a.push("?",b);(b=this.t)&&a.push("#",T(b,Da));return a.join("")};m.o=function(){return new Q(this)};
function xa(a,b,c){R(a);a.n=c?b?decodeURIComponent(b):"":b;if(a.n)a.n=a.n.replace(/:$/,"")}function ya(a,b){R(a);if(b){b=Number(b);if(isNaN(b)||b<0)throw Error("Bad port number "+b);a.A=b}else a.A=j}function za(a,b,c){R(a);if(b instanceof S){a.h=b;a.h.F(a.e)}else{c||(b=T(b,Ea));a.h=new S(b,0,a.e)}}function R(a){if(a.R)throw Error("Tried to modify a read-only Uri");}m.F=function(a){this.e=a;this.h&&this.h.F(a);return this};function T(a,b){if(t(a))return encodeURI(a).replace(b,Fa);return j}
function Fa(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Aa=/[#\/\?@]/g,Ca=/[\#\?:]/g,Ba=/[\#\?]/g,Ea=/[\#\?@]/g,Da=/#/g;function S(a,b,c){this.d=a||j;this.e=!!c}function U(a){if(!a.b){a.b=new O;a.a=0;if(a.d)for(var b=a.d.split("&"),c=0;c<b.length;c++){var d=b[c].indexOf("="),f=j,e=j;if(d>=0){f=b[c].substring(0,d);e=b[c].substring(d+1)}else f=b[c];f=decodeURIComponent(f.replace(/\+/g," "));f=V(a,f);a.add(f,e?decodeURIComponent(e.replace(/\+/g," ")):"")}}}m=S.prototype;
m.b=j;m.a=j;m.add=function(a,b){U(this);this.d=j;a=V(this,a);var c=this.b.k(a);c||this.b.j(a,c=[]);c.push(b);this.a++;return this};m.remove=function(a){U(this);a=V(this,a);if(this.b.p(a)){this.d=j;this.a-=this.b.k(a).length;return this.b.remove(a)}return k};m.p=function(a){U(this);a=V(this,a);return this.b.p(a)};m.l=function(){U(this);for(var a=this.b.f(),b=this.b.l(),c=[],d=0;d<b.length;d++)for(var f=a[d],e=0;e<f.length;e++)c.push(b[d]);return c};
m.f=function(a){U(this);var b=[];if(a){if(this.p(a))b=sa(b,this.b.k(V(this,a)))}else{a=this.b.f();for(var c=0;c<a.length;c++)b=sa(b,a[c])}return b};m.j=function(a,b){U(this);this.d=j;a=V(this,a);if(this.p(a))this.a-=this.b.k(a).length;this.b.j(a,[b]);this.a++;return this};m.k=function(a,b){var c=a?this.f(a):[];return c.length>0?String(c[0]):b};
m.toString=function(){if(this.d)return this.d;if(!this.b)return"";for(var a=[],b=this.b.l(),c=0;c<b.length;c++){var d=b[c],f=encodeURIComponent(String(d));d=this.f(d);for(var e=0;e<d.length;e++){var g=f;if(d[e]!=="")g+="="+encodeURIComponent(String(d[e]));a.push(g)}}return this.d=a.join("&")};m.o=function(){var a=new S;a.d=this.d;if(this.b)a.b=this.b.o();return a};function V(a,b){var c=String(b);if(a.e)c=c.toLowerCase();return c}
m.F=function(a){if(a&&!this.e){U(this);this.d=j;va(this.b,function(b,c){var d=c.toLowerCase();if(c!=d){this.remove(c);this.remove(d);if(b.length>0){this.d=j;this.b.j(V(this,d),ta(b));this.a+=b.length}}},this)}this.e=a};function Ga(){if(Ha)this.N=Error().stack}var Ia=0,Ha=k;m=Ga.prototype;m.key=0;m.m=k;m.G=k;m.u=function(a,b,c,d,f,e){if(q(a)=="function")this.J=h;else if(a&&a.handleEvent&&q(a.handleEvent)=="function")this.J=k;else throw Error("Invalid listener argument");this.v=a;this.L=b;this.src=c;this.type=d;this.capture=!!f;this.I=e;this.G=k;this.key=++Ia;this.m=k};m.handleEvent=function(a){if(this.J)return this.v.call(this.I||this.src,a);return this.v.handleEvent.call(this.v,a)};var Ja=!D||M(),Ka=!D||M(),La=D&&!L("8");!F||L("528");E&&L("1.9b")||D&&L("8")||ga&&L("9.5")||F&&L("528");E&&!L("8")||D&&L("9");function Ma(){if(Na){this.N=Error().stack;u(this)}}var Na=k;function W(a,b){this.type=a;this.currentTarget=this.target=b}W.prototype.C=k;W.prototype.H=k;W.prototype.V=h;W.prototype.preventDefault=function(){this.H=h;this.V=k};function Oa(a){Oa[" "](a);return a}Oa[" "]=function(){};function X(a,b){a&&this.u(a,b)}ca(X,W);var Pa=[1,4,2];m=X.prototype;m.target=j;m.relatedTarget=j;m.offsetX=0;m.offsetY=0;m.clientX=0;m.clientY=0;m.screenX=0;m.screenY=0;m.button=0;m.keyCode=0;m.charCode=0;m.ctrlKey=k;m.altKey=k;m.shiftKey=k;m.metaKey=k;m.T=k;m.s=j;
m.u=function(a,b){var c=this.type=a.type;W.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(E){var f;a:{try{Oa(d.nodeName);f=h;break a}catch(e){}f=k}f||(d=j)}}else if(c=="mouseover")d=a.fromElement;else if(c=="mouseout")d=a.toElement;this.relatedTarget=d;this.offsetX=F||a.offsetX!==undefined?a.offsetX:a.layerX;this.offsetY=F||a.offsetY!==undefined?a.offsetY:a.layerY;this.clientX=a.clientX!==undefined?a.clientX:a.pageX;this.clientY=a.clientY!==undefined?
a.clientY:a.pageY;this.screenX=a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||(c=="keypress"?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.T=ia?a.metaKey:a.ctrlKey;this.state=a.state;this.s=a;a.H&&this.preventDefault();delete this.C};
m.preventDefault=function(){X.X.preventDefault.call(this);var a=this.s;if(a.preventDefault)a.preventDefault();else{a.returnValue=k;if(La)try{if(a.ctrlKey||a.keyCode>=112&&a.keyCode<=123)a.keyCode=-1}catch(b){}}};var Y={},Z={},$={},Qa={};
function Ra(a,b,c,d,f){if(b)if(q(b)=="array"){for(var e=0;e<b.length;e++)Ra(a,b[e],c,d,f);return j}else{d=!!d;var g=Z;b in g||(g[b]={a:0,i:0});g=g[b];if(!(d in g)){g[d]={a:0,i:0};g.a++}g=g[d];var i=u(a),l;g.i++;if(g[i]){l=g[i];for(e=0;e<l.length;e++){g=l[e];if(g.v==c&&g.I==f){if(g.m)break;return l[e].key}}}else{l=g[i]=[];g.a++}e=Sa();e.src=a;g=new Ga;g.u(c,e,a,b,d,f);c=g.key;e.key=c;l.push(g);Y[c]=g;$[i]||($[i]=[]);$[i].push(g);if(a.addEventListener){if(a==p||!a.O)a.addEventListener(b,e,d)}else a.attachEvent(Ta(b),
e);return c}else throw Error("Invalid event type");}function Sa(){var a=Ua,b=Ka?function(c){return a.call(b.src,b.key,c)}:function(c){c=a.call(b.src,b.key,c);if(!c)return c};return b}function Va(a,b,c,d){if(!d.w)if(d.K){for(var f=0,e=0;f<d.length;f++)if(d[f].m)d[f].L.src=j;else{if(f!=e)d[e]=d[f];e++}d.length=e;d.K=k;if(e==0){delete Z[a][b][c];Z[a][b].a--;if(Z[a][b].a==0){delete Z[a][b];Z[a].a--}Z[a].a==0&&delete Z[a]}}}function Ta(a){if(a in Qa)return Qa[a];return Qa[a]="on"+a}
function Wa(a,b,c,d,f){var e=1;b=u(b);if(a[b]){a.i--;a=a[b];if(a.w)a.w++;else a.w=1;try{for(var g=a.length,i=0;i<g;i++){var l=a[i];if(l&&!l.m)e&=Xa(l,f)!==k}}finally{a.w--;Va(c,d,b,a)}}return Boolean(e)}
function Xa(a,b){if(a.G){var c=a.key;if(Y[c]){var d=Y[c];if(!d.m){var f=d.src,e=d.type,g=d.L,i=d.capture;if(f.removeEventListener){if(f==p||!f.O)f.removeEventListener(e,g,i)}else f.detachEvent&&f.detachEvent(Ta(e),g);f=u(f);if($[f]){g=$[f];var l=qa(g,d);l>=0&&N.splice.call(g,l,1);g.length==0&&delete $[f]}d.m=h;if(d=Z[e][i][f]){d.K=h;Va(e,i,f,d)}delete Y[c]}}}return a.handleEvent(b)}
function Ua(a,b){if(!Y[a])return h;var c=Y[a],d=c.type,f=Z;if(!(d in f))return h;f=f[d];var e,g;if(!Ka){var i;if(!(i=b))a:{i="window.event".split(".");for(var l=p;e=i.shift();)if(l[e]!=j)l=l[e];else{i=j;break a}i=l}e=i;i=h in f;l=k in f;if(i){if(e.keyCode<0||e.returnValue!=undefined)return h;a:{var o=k;if(e.keyCode==0)try{e.keyCode=-1;break a}catch(v){o=h}if(o||e.returnValue==undefined)e.returnValue=h}}o=new X;o.u(e,this);e=h;try{if(i){for(var n=[],w=o.currentTarget;w;w=w.parentNode)n.push(w);g=f[h];
g.i=g.a;for(var r=n.length-1;!o.C&&r>=0&&g.i;r--){o.currentTarget=n[r];e&=Wa(g,n[r],d,h,o)}if(l){g=f[k];g.i=g.a;for(r=0;!o.C&&r<n.length&&g.i;r++){o.currentTarget=n[r];e&=Wa(g,n[r],d,k,o)}}}else e=Xa(c,o)}finally{if(n)n.length=0}return e}d=new X(b,this);return e=Xa(c,d)};function Ya(a){Ma.call(this);this.Q=a;this.c=[]}ca(Ya,Ma);var Za=[];Ya.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented");};var $a=[{pattern:"[^#]+",subst:"http://docs.google.com/viewer?url=$0",conditions:[{type:0,regexp:"^https?://"},{type:0,regexp:"\\.(?:pdf|docx?|xlsx?|pptx?|pages|eps|ps|xps)(?:[?#]|$)"}]}],ab=[{pattern:"[^#]+",subst:"http://docs.google.com/viewer?url=$0",conditions:[{type:0,regexp:"^https?://"},{type:0,regexp:"\\.(?:ai|psd|tiff?|dxf|ttf)(?:[?#]|$)"}]}],bb=[{pattern:"([\\?&])hl=\\w+",subst:"$1hl={lang}",conditions:[{type:0,regexp:"^https?://maps.google.[^/]+/maps"},{type:2,regexp:"^https?://www.google.com/calendar"}]}];!D||M();!E&&!D||D&&M()||E&&L("1.9.1");D&&L("9");function cb(a){var b="a".toUpperCase();return db(a,function(c){return(!b||c.nodeName==b)&&h})}function db(a,b){for(var c=0;a;){if(b(a))return a;a=a.parentNode;c++}return j};function eb(a){var b=this.P=new Ya(this),c=window,d=this.S,f="mousedown";if(q(f)!="array"){Za[0]=f;f=Za}for(var e=0;e<f.length;e++)b.c.push(Ra(c,f[e],d||b,k,b.Q||b));this.D=[];try{var g=a.presets||{};b=[];if(g.documents)b=b.concat($a);if(g.images)b=b.concat(ab);if(g.maps){var i=bb[0];b.push({pattern:i.pattern,subst:i.subst.replace("{lang}",g.maps_lang||""),conditions:i.conditions})}var l=b.concat(a.rules||[]),o;a=0;for(var v=l.length;a<v;++a){var n=l[a];g=j;if(n.pattern){g={pattern:RegExp(n.pattern),
W:""+n.subst,r:[]};var w=n.conditions;i=void 0;if(s(w)){b=0;for(var r=w.length;b<r;++b){var fa=w[b];c=j;if(fa.regexp)c={type:fa.type,U:RegExp(fa.regexp)};if(i=c)g.r[g.r.length]=i}}if(g.r.length<=0)g=j}if(o=g)this.D[this.D.length]=o}}catch(hb){}}
eb.prototype.S=function(a){if((Ja?a.s.button==0:a.type=="click"||a.s.button&Pa[0])&&!(F&&ia&&a.ctrlKey))if(a=cb(a.target))if(/^https?:\/\/(?:www|encrypted)\.google\.(?:com|com?\.\w\w|\w\w)\/url\?/.test(a.href)){var b=a.href instanceof Q?a.href.o():new Q(a.href,void 0),c=b.h.k("url");if(c)if(c=fb(this,window.location.href,c)){R(b);b.h.j("url",c);a.href=b.toString()}}else if(b=fb(this,window.location.href,a.href))a.href=b};
function gb(a,b,c){for(var d=0,f=a.length;d<f;++d){var e=a[d].type,g=a[d].U;if(e==2){if(!g.test(b))return k}else if(e==3){if(g.test(b))return k}else if(e==0){if(!g.test(c))return k}else if(e==1)if(g.test(c))return k}return h}function fb(a,b,c){var d=a.D,f=0;for(a=d.length;f<a;++f)if(gb(d[f].r,b,c))return c.replace(d[f].pattern,function(){var e=arguments;return d[f].W.replace(/\$([0-9\$])/g,function(g,i){return i=="$"?"$":i=="0"?encodeURIComponent(e[0]):e[i-0]||""})});return j}
chrome.extension.sendRequest({command:"connect"},function(a){a.command=="setup"&&new eb(a.settings)});})();
