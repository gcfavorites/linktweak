(function(){var g=this;
function i(a){var b=typeof a;if(b=="object")if(a){if(a instanceof Array)return"array";else if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if(c=="[object Window]")return"object";if(c=="[object Array]"||typeof a.length=="number"&&typeof a.splice!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("splice"))return"array";if(c=="[object Function]"||typeof a.call!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if(b==
"function"&&typeof a.call=="undefined")return"object";return b}function j(a){return a.call.apply(a.bind,arguments)}function k(a,b){var c=b||g;if(arguments.length>2){var h=Array.prototype.slice.call(arguments,2);return function(){var d=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(d,h);return a.apply(c,d)}}else return function(){return a.apply(c,arguments)}}
function l(){l=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?j:k;return l.apply(null,arguments)};function m(a){a=String(a);var b;b=/^\s*$/.test(a)?false:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x10-\x1f\x80-\x9f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,""));if(b)try{return eval("("+a+")")}catch(c){}throw Error("Invalid JSON string: "+a);};function n(){chrome.extension.onRequest.addListener(l(this.a,this))}
n.prototype.a=function(a,b,c){if(a.command=="connect"){a=null;try{a=m(localStorage.linktweak_settings)}catch(h){}if(!a)try{var d=m(localStorage.rewriterules||"");b=[];var e,f=i(d);if(f=="array"||f=="object"&&typeof d.length=="number")for(f=0;f<d.length;++f)if((e=d[f])&&e.cond&&e.from)b[b.length]={pattern:e.from,subst:e.to||"",conditions:[{type:0,regexp:e.cond}]};a={version:1,presets:{},rules:b}}catch(o){}c({command:"setup",settings:a||{}})}};new n;})();
