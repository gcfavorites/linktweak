(function(){function h(a){var b=typeof a;if(b=="object")if(a){if(a instanceof Array)return"array";else if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if(c=="[object Window]")return"object";if(c=="[object Array]"||typeof a.length=="number"&&typeof a.splice!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("splice"))return"array";if(c=="[object Function]"||typeof a.call!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if(b=="function"&&typeof a.call=="undefined")return"object";return b}function i(a){return a.call.apply(a.bind,arguments)}function j(a,b){if(!a)throw Error();if(arguments.length>2){var c=Array.prototype.slice.call(arguments,2);return function(){var g=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(g,c);return a.apply(b,g)}}else return function(){return a.apply(b,arguments)}}
function k(){k=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?i:j;return k.apply(null,arguments)};function l(){chrome.extension.onRequest.addListener(k(this.a,this))}
l.prototype.a=function(a,b,c){if(a.command=="connect"){a=null;try{a=JSON.parse(localStorage.linktweak_settings)}catch(g){}if(!a)try{var f=JSON.parse(localStorage.rewriterules||"");b=[];var d,e=h(f);if(e=="array"||e=="object"&&typeof f.length=="number")for(e=0;e<f.length;++e)if((d=f[e])&&d.cond&&d.from)b[b.length]={pattern:d.from,subst:d.to||"",conditions:[{type:0,regexp:d.cond}]};a={version:1,presets:{},rules:b}}catch(m){}c({command:"setup",settings:a||{}})}};new l;})();
